export const STAGE_2_VERIFY_PRICE = `━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
STAGE 2: 필터링 된 30개 종목 전일종가 초정밀 검증 v4.0
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🚨🚨🚨 치명적 경고: 이 단계 실패 시 전체 분석 무효 🚨🚨🚨

⚠️ 검증된 전일종가는 최종 JSON에 포함됩니다

══════════════════════════════════════════════════════════════
STEP 0: 날짜 확정 (100% 정확한 거래일 계산)
══════════════════════════════════════════════════════════════

🔴 CRITICAL: 절대 추측 금지. 반드시 Google Search로 확인!

【1단계: 오늘 날짜 확인】
검색 실행: "오늘 날짜 한국" 또는 "current date Korea"
→ 검색 결과를 today 변수에 저장
예시: "2024년 12월 20일 금요일" → today = 2024-12-20

【2단계: 전일 거래일 계산】
IF today = 월요일(weekday=0):
   previous_day = today - 3일 (지난주 금요일)
ELSE IF today = 화요일(weekday=1):
   previous_day = today - 1일
ELSE IF today = 수요일(weekday=2):
   previous_day = today - 1일
ELSE IF today = 목요일(weekday=3):
   previous_day = today - 1일
ELSE IF today = 금요일(weekday=4):
   previous_day = today - 1일
ELSE IF today = 토요일(weekday=5) OR 일요일(weekday=6):
   ❌ 오류: "주말에는 주식 분석 불가능"

【3단계: 공휴일 체크】
한국 공휴일 리스트 2024:
2024-01-01 (신정)
2024-02-09, 2024-02-10, 2024-02-11 (설날)
2024-03-01 (삼일절)
2024-04-10 (국회의원선거)
2024-05-05 (어린이날)
2024-05-06 (대체공휴일)
2024-05-15 (부처님오신날)
2024-06-06 (현충일)
2024-08-15 (광복절)
2024-09-16, 2024-09-17, 2024-09-18 (추석)
2024-10-03 (개천절)
2024-10-09 (한글날)
2024-12-25 (크리스마스)

한국 공휴일 리스트 2025:
2025-01-01 (신정)
2025-01-28, 2025-01-29, 2025-01-30 (설날)
2025-03-01 (삼일절)
2025-03-03 (대체공휴일)
2025-05-05 (어린이날)
2025-05-06 (부처님오신날)
2025-06-06 (현충일)
2025-08-15 (광복절)
2025-10-05, 2025-10-06, 2025-10-07 (추석)
2025-10-03 (개천절)
2025-10-09 (한글날)
2025-12-25 (크리스마스)

WHILE previous_day IN 공휴일리스트 OR previous_day.weekday >= 5:
   previous_day = previous_day - 1일

【4단계: 검증 검색】
검색 실행: "한국 주식시장 [previous_day] 거래일"
IF 검색결과에 "거래일" OR "장 마감" OR "종가" 포함:
   ✅ 거래일 확인
ELSE:
   ❌ 오류: 재계산 필요

【5단계: 최종 확정】
target_date = previous_day

출력 형식:
- 전일 거래일: YYYY년 MM월 DD일 (요일)
- 영문 형식: YYYY-MM-DD
- 숫자 형식: YYYYMMDD

예시:
전일 거래일: 2024년 12월 19일 (목요일)
영문 형식: 2024-12-19
숫자 형식: 20241219

🔴 이 날짜를 모든 검색에 사용!

══════════════════════════════════════════════════════════════
STEP 1: 5개 소스 동시 조회 (Google Search 필수)
══════════════════════════════════════════════════════════════

🔴 MANDATORY: 반드시 5개 소스 모두 Google Search로 조회!
🔴 STEP 0에서 확정된 target_date 사용!

소스1: 네이버증권
검색: "종목명 YYYY년 MM월 DD일 종가 site:finance.naver.com"
확인: ✓종가(정수) ✓거래일(YYYY-MM-DD) ✓거래량
기록: 소스1_가격 = [금액]원 (거래일: YYYY-MM-DD)

소스2: 한국거래소
검색: "종목명 YYYYMMDD 종가 site:data.krx.co.kr"
확인: ✓종가(정수) ✓거래일
기록: 소스2_가격 = [금액]원 (거래일: YYYY-MM-DD)

소스3: 다음금융
검색: "종목명 YYYY-MM-DD 주가 site:finance.daum.net"
확인: ✓종가(정수) ✓거래일
기록: 소스3_가격 = [금액]원 (거래일: YYYY-MM-DD)

소스4: 인베스팅닷컴
검색: "종목명 YYYY-MM-DD stock price KRW site:investing.com"
확인: ✓종가(KRW정수) ✓거래일
기록: 소스4_가격 = [금액]원 (거래일: YYYY-MM-DD)

소스5: 서울경제/한국경제
검색: "종목명 YYYY년 MM월 DD일 시세 site:sedaily.com"
또는: "종목명 YYYY년 MM월 DD일 시세 site:hankyung.com"
확인: ✓종가(정수) ✓거래일
기록: 소스5_가격 = [금액]원 (거래일: YYYY-MM-DD)

예시 (target_date = 2024-12-19):
소스1: "삼성전자 2024년 12월 19일 종가 site:finance.naver.com"
소스2: "삼성전자 20241219 종가 site:data.krx.co.kr"
소스3: "삼성전자 2024-12-19 주가 site:finance.daum.net"
소스4: "삼성전자 2024-12-19 stock price KRW site:investing.com"
소스5: "삼성전자 2024년 12월 19일 시세 site:hankyung.com"

══════════════════════════════════════════════════════════════
STEP 2: 일치성 검증
══════════════════════════════════════════════════════════════

IF 5개 소스 중 3개 이상 정확히 일치:
   ✅ verified_close_price = 일치하는_값 (정수)
   ✅ confidence = 100%

ELSE IF 5개 소스 중 2개 일치 AND 둘 다 신뢰도 높은 소스:
   (신뢰도 높은 소스: naver, investing, krx, company_official)
   ⚠️ verified_close_price = 일치하는_값 (정수)
   ⚠️ confidence = 80%

ELSE:
   ❌ confidence < 80%
   ❌ 해당 종목 즉시 제외
   ❌ 다음 후보로 이동

══════════════════════════════════════════════════════════════
❌ 절대 금지 검색어
══════════════════════════════════════════════════════════════
❌ "종목명 전일종가"
❌ "종목명 어제 주가"
❌ "종목명 최근 종가"
❌ "종목명 현재가"
❌ "종목명 주가" (날짜 없음)

✅ 올바른 형식
══════════════════════════════════════════════════════════════
✅ "종목명 YYYY년 MM월 DD일 종가 site:도메인"
✅ "종목명 YYYYMMDD 종가 site:도메인"
✅ "종목명 YYYY-MM-DD 주가 site:도메인"
✅ 정확한 날짜 포함 필수
✅ site: 도메인 지정 권장

══════════════════════════════════════════════════════════════
STEP 3: 합리성 검증 (Sanity Checks)
══════════════════════════════════════════════════════════════

일간변동률 검증:
  daily_change = ABS((전일종가 - 전전일종가) / 전전일종가) × 100

  IF daily_change > 30%:
    🚨 상한가/하한가/거래정지 의심
    - "종목명 상한가 2025-10-15 site:krx.co.kr" 검색
    - "종목명 공시 2025-10-15 site:dart.fss.or.kr" 검색
    - 이상 확인 시 ❌ 종목 제외

  IF daily_change > 15% AND <= 30%:
    ⚠️ 급등/급락 재검증
    - "종목명 공시 2025-10-15" 검색
    - 중요 뉴스 확인

거래량 검증:
  volume_ratio = 전일거래량 / 평균20일거래량

  IF volume_ratio < 0.1:
    ⚠️ 유동성 부족 - 재검토

  IF volume_ratio > 10:
    🚨 이상 급등
    - "종목명 급등 이유 2025-10-15" 검색
    - 작전 의심 시 ❌ 제외

══════════════════════════════════════════════════════════════
STEP 4: 타임스탬프 동기화 검증
══════════════════════════════════════════════════════════════

검증:
  ✓ 모든 소스 거래일자 동일?
  ✓ 장 마감(15:30) 이후 데이터?
  ✓ 확정 종가 (장중 가격 X)?

IF 불일치:
  ❌ 종목 제외
  ❌ 다른 거래일 혼용 금지

══════════════════════════════════════════════════════════════
절대 금지 (Zero Tolerance)
══════════════════════════════════════════════════════════════

❌ "약 XX원", "~원대", "추정", "근사치"
❌ 범위 (예: "75,000-76,000원")
❌ 단일 소스만으로 확정
❌ 캐시 데이터 재사용
❌ 소수점 가격 (75,300.5원)
❌ 날짜 없는 검색
❌ 모호한 표현 ("최근", "현재")

══════════════════════════════════════════════════════════════
검증 완료 기준
══════════════════════════════════════════════════════════════

✅ 5개 중 3개 이상 정확히 일치 (100% confidence)
✅ 거래일자 동일성 확인
✅ 합리성 검증 통과
✅ 타임스탬프 동기화 확인
✅ 정수형 가격
✅ 장 마감 후 확정 종가

→ 모든 통과 후 STAGE 2 진행
→ 하나라도 실패 시 종목 제외

✅ 검증된 전일종가는 close_price 필드로 JSON에 포함

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【STAGE 2 최종 출력 형식】
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

STAGE 2 완료: 30개 종목 전일종가 검증 완료

【종목 1】
ticker: KOSPI:005930
name: 삼성전자
close_price: 75300
confidence: 100%

【종목 2】
ticker: KOSPI:000660
name: SK하이닉스
close_price: 142500
confidence: 100%

... (30개 종목 모두 동일한 형식)

【종목 30】
ticker: KOSDAQ:035420
name: NAVER
close_price: 215000
confidence: 100%

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

✅ 30개 종목 모두 전일종가 검증 완료
→ STAGE 3으로 전달
`;
